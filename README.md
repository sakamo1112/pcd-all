# ğŸŒˆ pcd_all ğŸŒˆ
ç‚¹ç¾¤ã‚’æ‰±ã†å‡¦ç†ã§ã‚ã‚Œã°ä½•ã§ã‚‚ä¸Šã’ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã§ã™.
<br><br>


## Overview ğŸ›¼
- [x] ç‚¹ç¾¤ã‚’ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹å‡¦ç†
- [ ] ç‚¹ç¾¤Viewer
- [x] ç‚¹ç¾¤ã®voxelåŒ–å‡¦ç†
- [x] éƒ½å¸‚ç‚¹ç¾¤ã‹ã‚‰ã®æ“¬ä¼¼èˆªç©ºå†™çœŸä½œæˆå‡¦ç†
- [x] [Mask3D](https://github.com/cvg/Mask3D)å®Ÿè¡Œçµæœã‚’ç‚¹ç¾¤ã«æŠ•å½±ã™ã‚‹å‡¦ç†
<br><br><br>


## ğŸ¨ ç‚¹ç¾¤ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°å‡¦ç†
#### å®Ÿè£…æ¸ˆã¿ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
- k-meansæ³•
- mean-shift
- DBSCAN
- HDBSCAN
<br><br>

#### å®Ÿè¡Œ
ä»¥ä¸‹ã®ã‚ˆã†ã«å„é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦å®Ÿè¡Œã—ã¾ã™.<br>
clustering.pyã®mainæ–‡ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã‚’è§£é™¤ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã‚‚åˆ©ç”¨å¯èƒ½ã§ã™.<br>
ç‚¹ç¾¤ãƒ‡ãƒ¼ã‚¿ã¯.pcdå½¢å¼ã§ã™.<br>
ã‚¯ãƒ©ã‚¹ã‚¿åˆ¥ã«BBoxã‚’ã¤ã‘ã‚‹å‡¦ç†ã€ã‚¯ãƒ©ã‚¹ã‚¿ã‚’BBoxã¨åŒã˜ã‚µã‚¤ã‚ºã®ãƒ¡ãƒƒã‚·ãƒ¥ã«ç½®ãæ›ãˆã‚‹å‡¦ç†ã‚‚å®Ÿè£…ã—ã¦ã„ã¾ã™.
```
from pcd_algorithm.clustering import Clustering
...

# k-meansæ³•ã‚’ä½¿ã†å ´åˆ
clustered_pcds = Clustering().k_means(pcd, <ã‚¯ãƒ©ã‚¹ã‚¿æ•°(int)>)

# mean-shiftã‚’ä½¿ã†å ´åˆ
clustered_pcds = Clustering().mean_shift(pcd, <ãƒãƒ³ãƒ‰å¹…ã®æ¨å®šã«ä½¿ç”¨ã™ã‚‹åˆ†ä½æ•°(float)>, <ãƒãƒ³ãƒ‰å¹…ã®æ¨å®šã«ä½¿ç”¨ã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«æ•°(int)>)

# DBSCANã‚’ä½¿ã†å ´åˆ
clustered_pcds = Clustering().dbscan(pcd, eps, min_points)

# HDBSCANã‚’ä½¿ã†å ´åˆ
clustered_pcds = Clustering().hdbscan(pcd, <ã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ§‹æˆã™ã‚‹ãŸã‚ã®æœ€å°ç‚¹æ•°(int)>)
```
<br><br><br>


## ğŸ§© ç‚¹ç¾¤ã®ãƒœã‚¯ã‚»ãƒ«åŒ–å‡¦ç†
ç‚¹ç¾¤ã‚’ãƒ­ãƒ¼ãƒãƒªã«ã—ã¦éŠã¹ã¾ã™.
#### å®Ÿè¡Œ
```
poetry run python pcd_algorithm/voxelize_pcd.py --pcd_path <ç‚¹ç¾¤ã®ãƒ‘ã‚¹> --voxel_size <ãƒœã‚¯ã‚»ãƒ«ã®ä¸€è¾ºã®é•·ã•>
```
<br>

#### å®Ÿè¡Œçµæœ
|å…¥åŠ›ç‚¹ç¾¤(æ—…é¤¨)|ãƒœã‚¯ã‚»ãƒ«åŒ–ã—ãŸçµæœ|
|---|---|
|![å…¥åŠ›ç‚¹ç¾¤(æ—…é¤¨)](https://github.com/sakamo1112/pcd-all/assets/125291665/4b4a8058-83ee-4293-bde0-fcc89cb8f10e)|![ãƒœã‚¯ã‚»ãƒ«åŒ–ã—ãŸçµæœ](https://github.com/sakamo1112/pcd-all/assets/125291665/edcf8400-4ff3-4107-a935-fc01325c465b)|
<br><br><br>


## ğŸ™ï¸ éƒ½å¸‚ç‚¹ç¾¤ã‹ã‚‰ã®æ“¬ä¼¼èˆªç©ºå†™çœŸä½œæˆå‡¦ç†
éƒ½å¸‚ç‚¹ç¾¤ã‚’æ“¬ä¼¼çš„ãªèˆªç©ºå†™çœŸã«å¤‰æ›ã—ã¾ã™.<br>
ãƒ€ãƒ ãƒ¢ãƒ¼ãƒ‰ã§ã¯ã€ä»»æ„ã®æ¨™é«˜ã¾ã§æ°´ä½ã‚’ä¸Šã’ãŸå ´åˆã®ç‚¹ç¾¤ãƒ‡ãƒ¼ã‚¿ã¨ãƒãƒƒãƒ—ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™.
#### å®Ÿè¡Œ
```
poetry run python pcd_algorithm/create_map.py --pcd_path <ç‚¹ç¾¤ã®ãƒ‘ã‚¹> --voxel_size <ç”»åƒä¸Šã§1pxã¨ã™ã‚‹è·é›¢> --dam_mode <ãƒ€ãƒ ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ã„ãŸã„å ´åˆTrue> --flood_height <ãƒ€ãƒ ãƒ¢ãƒ¼ãƒ‰ã§è¨­å®šã™ã‚‹æ°´é¢ã®é«˜ã•>
```
<br>

#### å®Ÿè¡Œçµæœ
|å…¥åŠ›ç‚¹ç¾¤|ä½œæˆã•ã‚ŒãŸæ“¬ä¼¼èˆªç©ºå†™çœŸ|
|---|---|
|![å…¥åŠ›ç‚¹ç¾¤](https://github.com/sakamo1112/pcd-all/assets/125291665/3c22e0fa-d511-4f89-a398-44bb3cd038ac)|![ä½œæˆã•ã‚ŒãŸæ“¬ä¼¼èˆªç©ºå†™çœŸ](https://github.com/sakamo1112/pcd-all/assets/125291665/32324088-d6fe-417b-8a8b-94964170f3fa)|
|ãƒ€ãƒ åŒ–ã•ã›ãŸç‚¹ç¾¤|ä½œæˆã•ã‚ŒãŸæ“¬ä¼¼èˆªç©ºå†™çœŸ(ãƒ€ãƒ åŒ–å¾Œ)|
|![ãƒ€ãƒ åŒ–ã•ã›ãŸç‚¹ç¾¤](https://github.com/sakamo1112/pcd-all/assets/125291665/2bfc6cc8-45a3-49f3-b34e-d34062223232)|![ä½œæˆã•ã‚ŒãŸæ“¬ä¼¼èˆªç©ºå†™çœŸ(ãƒ€ãƒ åŒ–å¾Œ)](https://github.com/sakamo1112/pcd-all/assets/125291665/c1c1eae2-2eca-418a-9c2e-6022c69d030a)|
<br><br><br>


## ğŸ­ Mask3Dã®çµæœæç”»å‡¦ç†
#### å®Ÿè¡Œ
```
poetry run python pcd_algorithm/Mask3D_mask.py 
--pcd_path <çµæœã‚’åæ˜ ã•ã›ãŸã„ç‚¹ç¾¤ãƒ‡ãƒ¼ã‚¿(.ply)ã®ãƒ‘ã‚¹> 
--Prefix <Mask3Dã§å¾—ã‚‰ã‚ŒãŸçµæœã‚’ã¾ã¨ã‚ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®æ ¼ç´å ´æ‰€(ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ‘ã‚¹)> 
--result_file_name <ã€Œå„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦ã®æ¤œå‡ºçµæœã‚’æ ¼ç´ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ã€ãŒã¾ã¨ã‚ã‚‰ã‚ŒãŸtxtãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰(ãƒ‘ã‚¹ã§ã¯ãªã„)>
```
ï¼ˆä¾‹ï¼‰å„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã¤ã„ã¦ã®æ¤œå‡ºçµæœã‚’æ ¼ç´ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ã€ã®ä¸­èº«
```
pred_mask/20231108_120945_room_0.txt 5 0.9574468731880188
pred_mask/20231108_120945_room_1.txt 16 0.9569514989852905
pred_mask/20231108_120945_room_2.txt 14 0.9293325543403625
pred_mask/20231108_120945_room_3.txt 8 0.9196611642837524
pred_mask/20231108_120945_room_4.txt 10 0.9063308835029602
```
<br>

#### å®Ÿè¡Œçµæœ
|å¤§å­¦ç”Ÿã®éƒ¨å±‹ã®ç‚¹ç¾¤|Mask3DğŸ­é©ç”¨çµæœ|
|---|---|
|![å¤§å­¦ç”Ÿã®éƒ¨å±‹ã®ç‚¹ç¾¤](https://github.com/sakamo1112/pcd-all/assets/125291665/6363f1ce-6ec1-4607-8771-d17f7535bbb7)|![Mask3Dé©ç”¨çµæœ](https://github.com/sakamo1112/pcd-all/assets/125291665/0f43c9bb-1cf3-4ac2-b4b6-5b018eb951f4)|

